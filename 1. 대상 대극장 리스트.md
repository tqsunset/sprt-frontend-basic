## 1. 대상 대극장 리스트

(띄워쓰기 및 표기는 playDB기준)

예술의 전당 오페라극장
샤롯데씨어터
블루스퀘어 신한카드홀
세종문화회관 대극장
대학로 드림아트센터 1관
두산아트센터 연강홀
광림아트센터 BBCH홀
홍익대 대학로 아트센터 대극장
아트원씨어터 1관
충무아트센터 대극장
대성 디큐브아트센터
예술의전당 CJ 토월극장 

해당되는 현재공연 / 공연예정인 뮤지컬들만 간트 차트에 표시되도록 할 것이다.

대극장이 12개가 있고 플레이디비 뮤지컬 페이지의 리스트는 15개이므로  현재공연 / 공연예정 각각 1페이지만 크롤링하면 된다.

## 2.  PlayDB 크롤링 작업

플레이디비 현재공연 리스트 1페이지에 있는 모든 공연의 정보를 크롤링하는 코드이다.

```python
from bs4 import BeautifulSoup
import requests

headers = {'User-Agent' : 'Mozilla/5.0 (Windows NT 10.0; Win64; x64)AppleWebKit/537.36 (KHTML, like Gecko) Chrome/73.0.3683.86 Safari/537.36'}
data = requests.get('http://www.playdb.co.kr/playdb/playdblist.asp?sReqMainCategory=000001&sReqSubCategory=&sReqDistrict=&sReqTab=2&sPlayType=2&sStartYear=&sSelectType=2', headers=headers)

page = BeautifulSoup(data.text, 'html.parser')

trs = page.select('#contents > div.container1 > table > tr')
movieTable =trs[10]
extract = movieTable.select('td > table > tr > td > table > tr > td > table > tr > td > table')

for table in extract:
    playName = table.select_one('tr > td > b > font > a')
    if playName is not None:
        info = table.text.strip()
        infoParse = info.split(':')

        infoParse[0] = infoParse[0].rstrip('세부장르 \n\t\r')
        infoParse[1] = infoParse[1].strip('일시 ')
        infoParse[2] = infoParse[2].strip('장소 ')
        infoParse[3] = infoParse[3].strip('출연 ')

        if len(infoParse) > 4:
            infoParse[4] = infoParse[4].strip('Staff ')
        elif len(infoParse) > 5:
            infoParse[5] = infoParse[5].strip()

        print(infoParse)   
```

##### 결과

```
['마리 앙투아네트', '라이선스', '2021.07.13 ~ 2021.10.03', '샤롯데씨어터', '김소현, 김소향, 김연지, 정유지, ...]
['광화문 연가', '창작', '2021.07.16 ~ 2021.09.05', '예술의전당 오페라극장', '윤도현, 엄기준, 강필석, ...]
['드라큘라', '라이선스', '2021.05.20 ~ 2021.08.01', '블루스퀘어 신한카드홀 (구 인터파크홀)', '김준수, 전동석, 신성록,....]
['비틀쥬스', '라이선스', '2021.07.06 ~ 2021.08.08', '세종문화회관 대극장', '유준상, 정성화, 홍나현, 장민제, 김지우, ...]
['해적', '창작', '2021.06.15 ~ 2021.08.29', '대학로 드림아트센터 1관', '정동화, 최석진, 김이후, 김대현, 주민진, 김려원', ' 이희준, 박정아']
['마마 돈 크라이', '창작', '2021.05.27 ~ 2021.08.22', '두산아트센터 연강홀', '송용진, 허규, 조형균, 백형훈,...]
['태양의 노래', '라이선스', '2021.05.01 ~ 2021.07.25', '광림아트센터 BBCH홀', '온유, 원필, 조훈, 백호, 영재, ...]
['레드북', '창작', '2021.06.04 ~ 2021.08.22', '홍익대 대학로 아트센터 대극장', '차지연, 아이비, 김세정, 송원근, ...]
['와일드 그레이', '창작', '2021.06.03 ~ 2021.08.15', '아트원씨어터 1관', '에녹, 정민, 박민성, 정휘, 박준휘, 백동현, 배나라, 홍승안, ...]
['스프링 어웨이크닝', '라이선스', '2021.07.08 ~ 2021.10.03', '이해랑 예술극장', '박석용, 류수화, 노윤, 황휘, 김서연, 이정화, 김현진, 이봉준, 오유민, 신한결, 윤재호, 김서환, 이주순, 문이보, 전혜주, 김수혜, 유효진, 최경록, 신석수, 김대식', ' 이종석, 이나영, 스티븐 세이터']
['홀연했던 사나이', '창작', '2021.07.08 ~ 2021.09.26', '대학로 티오엠 1관', '정민, 박민성, 수현, 손유동, 최민우, 김태오, 한보라, 이현진, 유성재, 황성현, 조은진, 김수진, 장재웅, 김효성']
['박열', '창작', '2021.07.14 ~ 2021.09.12', '대학로 드림아트센터 4관', '김재범, 김순택, 백기범, 조훈, 이정화, 허혜진, 최지혜, 권용국, 문경초, 임별, 정지우', ' 김수로, 성종완']
['어쩌면 해피엔딩', '창작', '2021.06.22 ~ 2021.09.05', '예스24스테이지 1관', '신성민, 임준혁, 정욱진, 홍지희, 해나, 한재아, 성종완, 이선근', ' 윌 애런슨, 박천휴, 김동연, 주소연, 송희진']
['윤동주, 달을 쏘다.', '창작', '2021.07.10 ~ 2021.07.25', '예술의전당 CJ 토월극장', '박영수, 김용한, 김도빈, 조풍래, 송문선, 이혜수, 이기완, 정지만']
['난타 - 제주', '창작', '2017.01.10 ~ 오픈런', '제주 난타 전용극장']

```

- 개발자 도구에서 copy selector를 했을 때와 달리 직접 http 요청을 해서 받은 html 코드는 table >  tr > td > table > tr ...식으로 이상하게 nested된 구조였다. 왜째서인가요.
- `infoParse = info.split(':')` 이 부분에서 `rsplit()`을 써서 한번에 parsing을 할 수 있을 것 같음. 그러나 정규식을 어떻게 써야할지 모르겠고 뭣보다 시간이 오래 걸려서 번거롭더라도 지금 방법을 선택. 



## 2일차 미팅

- 프론트엔드
  - 팀원분들이 각자 생각해오신 레이아웃의 좋은 부분들을 취합해서 일단 전체적인 레이아웃이 정해짐.
  - 사진
  - 관건은 Gantt chart를 구현할 수 있느냐.
- 백엔드
  - 플레이디비를 소스로 크롤링을 하기로 정해짐
  - 대극장 필터링: 크롤링한 결과를 db에 넣기전 필터링할지, 아님 db에 넣고나서 필터링할지? 직접 해보고 논의. 개인적으론 전자가 더 문제의 소지가 적어보인다.
  -  remote pair-programming 방법



## 궁금한 점  

1. 개발자 도구에서 copy selector를 했을 때와 달리 직접 http 요청을 해서 받은 html 코드는 table >  tr > td > table > tr ...식으로 이상하게 nested된 구조를 가지고 있는가? 

2. 검색중에 크롤링 라이브러리 중 selenium도 많이 쓰인다는 사실을 알게되었다. 

   [이 글](http://www.gisdeveloper.co.kr/?p=10902)을 보니 동적웹페이지와 관련된 것 같기도 한데, 좀 더 자세히 알아보고 싶음. 그리고 동적웹페이지는 어떻게 크롤링을 하는지도 궁금.

3. 플레이디비 url에 들어있는 asp란 무엇인가?

4. 혹크롬 개발자툴에서처럼 파이참에서도 선택한 html요소의 selector를 쉽게 구할 수 있는 방법이 있을까? 아래 스크린샷 상의 빨갛게 표시된 selector 정보를 카피하고 싶은데 인터넷에선 아직 정보를 못 찾음.

   ![](/home/gwlee/sparta-beginner/sprt-frontend-basic/img/Screenshot from 2021-07-20 16-21-12.png)